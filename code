#include <Arduino.h> 
#include <Wire.h> 
#include <LiquidCrystal_PCF8574.h> 
int u=0; 
 
LiquidCrystal_PCF8574 lcd(0x27);  // set the LCD address to 0x27 for a 16 
chars and 2 line display 
int t=0; 
int show = -1; 
// 2 custom characters 
byte dotOff[] = { 0b00000, 0b01110, 0b10001, 0b10001, 
                  0b10001, 0b01110, 0b00000, 0b00000 }; 
byte dotOn[] = { 0b00000, 0b01110, 0b11111, 0b11111, 
                 0b11111, 0b01110, 0b00000, 0b00000 }; 
void setup() { 
  int error; 
  Serial.begin(9600); 

  // wait on Serial to be available on Leonardo 
  while (!Serial) 
    ; 
  
  // See http://playground.arduino.cc/Main/I2cScanner how to test for a I2C 
device. 
  Wire.begin(); 
  Wire.beginTransmission(0x27); 
  error = Wire.endTransmission(); 
  if (error == 0) {   
    show = 0; 
    lcd.begin(16,2);  // initialize the lcd 
    lcd.createChar(1, dotOff); 
    lcd.createChar(2, dotOn); 
  } else { 
  }  // if 
 lcd.setBacklight(255); 
    lcd.home();  
    lcd.clear(); 
    lcd.print("  ENERGY"); 
    lcd.setCursor(0,1); 
    lcd.print(" MANAGEMENT IOT "); 
    delay(4000); 
    pinMode(5,OUTPUT); 
}  // setup() 
 
void loop() { 
    t++; 
   float v=analogRead(A0); 
   float c=analogRead(A1);
   v=(v/1023)*400; 
   c=(c/1023)*60; 
   float p=v*c; 
   lcd.clear(); 
   lcd.print("V:"); 
   lcd.print(v); 
   lcd.print(" C:"); 
   lcd.print(c); 
   lcd.setCursor(0,1); 
   lcd.print("P:"); 
   lcd.print(p); 
   lcd.print(" U:"); 
   lcd.print(u); 
   lcd.print(" D:"); 
   lcd.print(t); 
   delay(1000); 
  Serial.print(v); 
  Serial.print(","); 
  Serial.print(c); 
  Serial.print(","); 
  Serial.print(p); 
  Serial.print(","); 
  Serial.print(u); 
  Serial.print(","); 
  Serial.println("0"); 
    if(p>500) 
    { 
      u++; 
      delay(100); 
    } 
   if(v>240){ 
     lcd.clear(); 
    lcd.print("VOLTAGE HIGH"); 
    digitalWrite(5,HIGH); 
   } 
   else if(v<200){ 
     lcd.clear(); 
    lcd.print("VOLTAGE LOW"); 
    digitalWrite(5,HIGH);
   } 
   else if(c>15){ 
     lcd.clear(); 
    lcd.print("OVER CURRENT"); 
    digitalWrite(5,HIGH); 
   } 
   else{ 
     digitalWrite(5,LOW); 
   } 
   delay(1000); 
}  // loop()
